<!-- prettier-ignore -->
{% extends 'store/main.html' %}
{% load static %}
{% block content %}

<div class="row">
	<div class="col-lg-6">
		<div class="box-element" id="form-wrapper">
			<form action="post" id="form">
				<!-- User Info -->
				<div id="user-info">
					<p>User Information:</p>

					<div class="form-field">
						<input
							required
							class="form-control"
							type="text"
							name="name"
							placeholder="Name.."
						/>
					</div>
					<div class="form-field">
						<input
							required
							class="form-control"
							type="email"
							name="email"
							placeholder="Email.."
						/>
					</div>
				</div>
				<hr />
				<!-- User Address -->
				<div id="shipping-info">
					<p>Shipping Information:</p>

					<div class="form-field">
						<input
							class="form-control"
							type="text"
							name="address"
							placeholder="Address.."
						/>
					</div>
					<div class="form-field">
						<input
							class="form-control"
							type="text"
							name="city"
							placeholder="City.."
						/>
					</div>
					<div class="form-field">
						<input
							class="form-control"
							type="text"
							name="state"
							placeholder="State.."
						/>
					</div>
					<div class="form-field">
						<input
							class="form-control"
							type="text"
							name="zipcode"
							placeholder="Zip code.."
						/>
					</div>
				</div>

				<input
					id="form-button"
					class="btn btn-success btn-block"
					type="submit"
					value="Continue"
				/>
			</form>
		</div>
		<br />
		<!-- Payment Options -->
		<div class="box-element hidden" id="payment-info">
			<p>Paypal Options:</p>
			<button id="make-payment" class="btn btn-success btn-block">
				Make Payment
			</button>
		</div>
	</div>

	<div class="col-lg-6">
		<div class="box-element">
			<a href="{% url 'cart' %}" class="btn btn-outline-dark"
				><span class="spcl-ch">↞ </span>Back to Cart</a
			>
			<hr />
			<h3>Order Summary</h3>
			<hr />
			{% for item in items %}
			<div class="cart-row">
				<div style="flex: 2">
					{% if item.product.imageURL %}
					<img
						src="{{item.product.imageURL}}"
						class="row-image"
						alt="cart-product-image"
					/>
					{% else %}
					<img
						src="{% static 'images/placeholder.png' %}"
						class="row-image"
						alt="cart-product-image"
					/>
					{% endif %}
				</div>
				<div style="flex: 2"><p>{{item.product.name}}</p></div>
				<div style="flex: 1">
					<p>₹{{item.product.price|floatformat:2}}</p>
				</div>
				<div style="flex: 1"><p>x{{item.quantity}}</p></div>
			</div>
			{% endfor %}
			<h5>Items: {{order.get_total_cart_items}}</h5>
			<h5>Total: ₹{{order.get_total_cart_price|floatformat:2}}</h5>
		</div>
	</div>
</div>

<script>
	//? Check if shpping info is required
	let need_shipping = "{{order.need_shipping}}";

	if (need_shipping === "False") {
		document.querySelector("#shipping-info").innerHTML = "";
	}

	//? Add Event listener to the form
	const formTag = document.querySelector("#form");
	const submitBtnTag = document.querySelector("#form-button");
	const paymentTag = document.querySelector("#payment-info");

	function submitFormData() {
		console.log("Form Data processed");
	}

	formTag.addEventListener("submit", function (e) {
		e.preventDefault();

		submitFormData();
		console.log("Form submitted");
		// hide submit button
		submitBtnTag.classList.add("hidden");
		// reveal payment option
		paymentTag.classList.remove("hidden");
	});
</script>

{% endblock content %}
